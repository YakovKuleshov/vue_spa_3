"use strict";(self["webpackChunkport"]=self["webpackChunkport"]||[]).push([[944],{9511:function(e,t){t["Z"]={activated(){const e=localStorage.getItem(`${this.$route.path.replace("/","")}_scroll`);e&&window.scrollTo({top:+e})}}},4944:function(e,t,l){l.r(t),l.d(t,{default:function(){return b}});var i=l(3396),s=l(7139);const n=e=>((0,i.dD)("data-v-3683ece8"),e=e(),(0,i.Cn)(),e),a={class:"main"},o=n((()=>(0,i._)("h2",{class:"page__title"},"Фильмы",-1))),r={class:"wrapper"},c={class:"container",ref:"filmsContainer"},m=["onClick"],d={class:"text__container"},h={class:"title__text"},g={class:"public__date"},p={key:0,class:"loading"},u=n((()=>(0,i._)("div",{class:"preloader"},null,-1))),w=n((()=>(0,i._)("div",{class:"loading__text"},"Загрузка...",-1))),v=[u,w];function f(e,t,l,n,u,w){return(0,i.wg)(),(0,i.iD)("div",a,[o,(0,i._)("div",r,[(0,i._)("div",c,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.list,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"list__item",onClick:t=>w.showInfo(e)},[(0,i._)("div",{class:"item__image",style:(0,s.j5)({backgroundImage:`url('${w.getImageUrl(e.element.basicCovers.items)}')`})},null,4),(0,i._)("div",d,[(0,i._)("div",h,(0,s.zw)(e.element.name),1),(0,i._)("div",g,(0,s.zw)(e.Year),1)])],8,m)))),128))],512),u.preloader?((0,i.wg)(),(0,i.iD)("div",p,v)):(0,i.kq)("",!0)])])}var _=l(9511),I={data(){return{preloader:!1,list:[],page:0}},mixins:[_.Z],watch:{},methods:{showInfo(e){this.getItemInfo(e)},scrollContent(){if(!this.flag)return!1;window.scrollY>=document.body.scrollHeight-window.innerHeight-200&&(this.page+=8,this.load(this.page),this.flag=!1)},getItemInfo(e){fetch(`https://ctx.playfamily.ru/screenapi/v1/noauth/moviecard/web/1?elementAlias=${e.element.alias}&elementType=MOVIE`,{}).then((e=>e.json())).then((e=>{const t={url:e.element.basicCovers.items[0].url,description:e.element.description,trailer:e.element.trailers.items[1].url,rating:e.element.kinopoiskRating,filmName:e.element.alias,type:e.element.type,year:new Date(e.element.worldReleaseDate).toLocaleString({},{year:"numeric"})};this.$emit("onFilmClick",t)}))},load(e,t){this.preloader=!0,fetch("https://ctx.playfamily.ru/screenapi/v1/noauth/collection/web/1?elementAlias=novelty_web&elementType=COLLECTION&limit=8&offset="+e+"&withInnerCollections=false").then((e=>e.json())).then((e=>{this.hasItems(e.element.collectionItems.items)&&(t&&setTimeout((()=>{this.$refs.filmsContainer.getBoundingClientRect().bottom<window.innerHeight&&(this.page+=20,this.load(this.page,t))})),0==this.page?this.list=e.element.collectionItems.items:this.list=this.list.concat(e.element.collectionItems.items),this.flag=!0),this.preloader=!1})).catch((e=>console.log(e)))},hasItems(e){return!(!e||!e.length)},getImageUrl(e){return e[0]&&e[0].url}},created(){this.load(this.page,!0)},activated(){this.scrollContent=this.scrollContent.bind(this),window.addEventListener("scroll",this.scrollContent)},deactivated(){window.removeEventListener("scroll",this.scrollContent)},beforeRouteLeave(e,{name:t},l){localStorage.setItem(`${t}_scroll`,window.scrollY),l()}},C=l(89);const y=(0,C.Z)(I,[["render",f],["__scopeId","data-v-3683ece8"]]);var b=y}}]);
//# sourceMappingURL=944.f88ab701.js.map